{
    "Python_magic": "mт\r\n", 
    "errors": [], 
    "warnings": [], 
    "Script_magic": 3, 
    "_body": "request = container.REQUEST\nresponse = request.RESPONSE\n\n#===============================================================================\n# переменные окружени€\n#===============================================================================\n\ntcode = request.get('tcode','') # тип кода\nuid = request.get('uid') # пользователь\nid_site = request.get('id_site') # ид экспедиции\ntid = request.get('tid','') # id телеги\ntovarid = request.get('tovarid') # шк товара\nprinttid = request.get('printtid') # хотим печатать шк телеги\nprintersk = request.get('printersk','') or '' # шк принтера\nlabelbarcode = request.get('labelbarcode') # распечатана€ этикетка\nid_shtask = request.get('id_shtask') # задание\nid_cart = request.get('id_cart')\nact = request.get('act')\nerr = None\nid_route = request.get('id_route')\ndate_out = request.get('date_out')\n\n#===============================================================================\n# погнали\n#===============================================================================\n\n##<dtml-sqlvar ID_EMPL type=\"int\" optional> \n\nif act == 'scan1' or act == 'select_route':    \n    if tid or act == 'scan1':        \n        route = container.GM_CARTINCOME_ROUTES(BARCODE = tid,\n                                            CHECK_TYPE = act,\n                                            ID_ROUTE_IN = None,\n                                            DATE_OUT = None)\n        if len(route) and route[0].MES:request = container.REQUEST\nresponse = request.RESPONSE\n\n#===============================================================================\n# переменные окружени€\n#===============================================================================\n\ntcode = request.get('tcode','') # тип кода\nuid = request.get('uid') # пользователь\nid_site = request.get('id_site') # ид экспедиции\ntid = request.get('tid','') # id телеги\ntovarid = request.get('tovarid') # шк товара\nprinttid = request.get('printtid') # хотим печатать шк телеги\nprintersk = request.get('printersk','') or '' # шк принтера\nlabelbarcode = request.get('labelbarcode') # распечатана€ этикетка\nid_shtask = request.get('id_shtask') # задание\nid_cart = request.get('id_cart')\nact = request.get('act')\nerr = None\nid_route = request.get('id_route')\ndate_out = request.get('date_out')\n\n#===============================================================================\n# погнали\n#===============================================================================\n\n##<dtml-sqlvar ID_EMPL type=\"int\" optional> \n\nif act == 'scan1' or act == 'select_route':    \n    if tid or act == 'scan1':        \n        route = container.GM_CARTINCOME_ROUTES(BARCODE = tid,\n                                            CHECK_TYPE = act,\n                                            ID_ROUTE_IN = None,\n                                            DATE_OUT = None)\n        if len(route) and route[0].MES:\n            err = route[0].MES\n        if not err:\n            id_route = route[0].ID_ROUTE\n        else:\n            route_list  = container.GM_CARTINCOME_LIST_ROUTES(ID_ROUTE_IN = None, DATE_OUT_CUR = None, CHECK_NOT_END_ROUTE = '1')\n            return container.frm_listCarRoute(id_shtask = id_shtask, id_site = id_site, route_list = route_list, err = err)\n    \n    \n    route_list  = container.GM_CARTINCOME_LIST_ROUTES(ID_ROUTE_IN = id_route, DATE_OUT_CUR = None, CHECK_NOT_END_ROUTE = '0')    \n    return container.frm_setCarRoute(id_shtask = id_shtask, id_site = id_site, route_list = route_list, err = err, confirm = 0)\n\nif act == 'scan2':\n    route = container.GM_CARTINCOME_ROUTES(BARCODE = tid,\n                                            CHECK_TYPE = act,\n                                            ID_ROUTE_IN = id_route,\n                                            DATE_OUT = date_out)\n    if len(route) and route[0].MES:\n        err = route[0].MES\n        date_out = None\n    if not err:\n        err = 'ƒл€ завершени€ работы с маршрутом, подтвердите отъезд'\n        date_out = route[0].DATE_OUT_CURR\n        \n    route_list  = container.GM_CARTINCOME_LIST_ROUTES(ID_ROUTE_IN = id_route, DATE_OUT_CUR = date_out, CHECK_NOT_END_ROUTE = '0')    \n    return container.frm_setCarRoute(id_shtask = id_shtask, id_site = id_site, route_list = route_list, err = err)\n    \nif act == 'setdateout':\n    route = container.GM_CARTINCOME_ROUTES(BARCODE = tid,\n                                            CHECK_TYPE = act,\n                                            ID_ROUTE_IN = id_route,\n                                            DATE_OUT = date_out)\n    return response.redirect('taskAction?uid=%s&id_site=%s&id_shtask=%s'%(request.uid, request.get('id_site'), request.get('id_shtask')))\n\nif act == 'start':\n    route_list  = container.GM_CARTINCOME_LIST_ROUTES(ID_ROUTE_IN = None, DATE_OUT_CUR = date_out, CHECK_NOT_END_ROUTE = '1')\n    return container.frm_listCarRoute(id_shtask = id_shtask, id_site = id_site, route_list = route_list, err = err)\n", 
    "id": "routeAction", 
    "_code": "c\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0001\u0000\u0000\u0000@\u0000\u0000\u0000s\r\u0000\u0000\u0000d\u0001\u0000Д\u0000\u0000Z\u0000\u0000d\u0000\u0000S(\u0002\u0000\u0000\u0000Nc\u0000\u0000\u0000\u0000\u0017\u0000\u0000\u0000\u001e\u0000\u0000\u0000C\u0000\u0000\u0000sT\u0006\u0000\u0000t\u0000\u0000t\u0001\u0000d\u0001\u0000Г\u0002\u0000}\u0002\u0000t\u0000\u0000|\u0002\u0000d\u0002\u0000Г\u0002\u0000}\u0003\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0004\u0000d\u0005\u0000Г\u0002\u0000}\u0004\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0006\u0000Г\u0001\u0000}\u0005\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0007\u0000Г\u0001\u0000}\u0006\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\b\u0000d\u0005\u0000Г\u0002\u0000}\u0007\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\t\u0000Г\u0001\u0000}\b\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\n\u0000Г\u0001\u0000}\t\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u000b\u0000d\u0005\u0000Г\u0002\u0000p\u0004\u0000\u0001d\u0005\u0000}\n\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\f\u0000Г\u0001\u0000}\u000b\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\r\u0000Г\u0001\u0000}\f\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u000e\u0000Г\u0001\u0000}\r\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u000f\u0000Г\u0001\u0000}\u000e\u0000t\u000f\u0000}\u0010\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0010\u0000Г\u0001\u0000}\u0011\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0011\u0000Г\u0001\u0000}\u0012\u0000|\u000e\u0000d\u0012\u0000j\u0002\u0000p\n\u0000\u0001|\u000e\u0000d\u0013\u0000j\u0002\u0000o\u0000\u0001|\u0007\u0000p\n\u0000\u0001|\u000e\u0000d\u0012\u0000j\u0002\u0000og\u0000\u0001t\u0000\u0000t\u0001\u0000d\u0014\u0000Г\u0002\u0000d\u0015\u0000|\u0007\u0000d\u0016\u0000|\u000e\u0000d\u0017\u0000t\u000f\u0000d\u0018\u0000t\u000f\u0000Г\u0000\u0004}\u0013\u0000t\u0014\u0000|\u0013\u0000Г\u0001\u0000o\u0016\u0000\u0001t\u0000\u0000t\u0015\u0000|\u0013\u0000d\u0019\u0000Г\u0002\u0000d\u001a\u0000Г\u0002\u0000o\u0013\u0000\u0001t\u0000\u0000t\u0001\u0000d\u0001\u0000Г\u0002\u0000}\u0002\u0000n\u0001\u0000\u0001n\u0001\u0000\u0001n\u0001\u0000\u0001t\u0000\u0000|\u0002\u0000d\u0002\u0000Г\u0002\u0000}\u0003\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0004\u0000d\u0005\u0000Г\u0002\u0000}\u0004\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0006\u0000Г\u0001\u0000}\u0005\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0007\u0000Г\u0001\u0000}\u0006\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\b\u0000d\u0005\u0000Г\u0002\u0000}\u0007\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\t\u0000Г\u0001\u0000}\b\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\n\u0000Г\u0001\u0000}\t\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u000b\u0000d\u0005\u0000Г\u0002\u0000p\u0004\u0000\u0001d\u0005\u0000}\n\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\f\u0000Г\u0001\u0000}\u000b\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\r\u0000Г\u0001\u0000}\f\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u000e\u0000Г\u0001\u0000}\r\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u000f\u0000Г\u0001\u0000}\u000e\u0000t\u000f\u0000}\u0010\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0010\u0000Г\u0001\u0000}\u0011\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0011\u0000Г\u0001\u0000}\u0012\u0000|\u000e\u0000d\u0012\u0000j\u0002\u0000p\n\u0000\u0001|\u000e\u0000d\u0013\u0000j\u0002\u0000oJ\u0001\u0001|\u0007\u0000p\n\u0000\u0001|\u000e\u0000d\u0012\u0000j\u0002\u0000oа\u0000\u0001t\u0000\u0000t\u0001\u0000d\u0014\u0000Г\u0002\u0000d\u0015\u0000|\u0007\u0000d\u0016\u0000|\u000e\u0000d\u0017\u0000t\u000f\u0000d\u0018\u0000t\u000f\u0000Г\u0000\u0004}\u0013\u0000t\u0014\u0000|\u0013\u0000Г\u0001\u0000o\u0016\u0000\u0001t\u0000\u0000t\u0015\u0000|\u0013\u0000d\u0019\u0000Г\u0002\u0000d\u001a\u0000Г\u0002\u0000o\u001c\u0000\u0001t\u0000\u0000t\u0015\u0000|\u0013\u0000d\u0019\u0000Г\u0002\u0000d\u001a\u0000Г\u0002\u0000}\u0010\u0000n\u0001\u0000\u0001|\u0010\u0000\fo\u001c\u0000\u0001t\u0000\u0000t\u0015\u0000|\u0013\u0000d\u0019\u0000Г\u0002\u0000d\u001b\u0000Г\u0002\u0000}\u0011\u0000nM\u0000\u0001t\u0000\u0000t\u0001\u0000d\u001c\u0000Г\u0002\u0000d\u0017\u0000t\u000f\u0000d\u001d\u0000t\u000f\u0000d\u001e\u0000d\u001f\u0000Г\u0000\u0003}\u0016\u0000t\u0000\u0000t\u0001\u0000d \u0000Г\u0002\u0000d\r\u0000|\f\u0000d\u0007\u0000|\u0006\u0000d!\u0000|\u0016\u0000d\"\u0000|\u0010\u0000Г\u0000\u0004Sn\u0001\u0000\u0001t\u0000\u0000t\u0001\u0000d\u001c\u0000Г\u0002\u0000d\u0017\u0000|\u0011\u0000d\u001d\u0000t\u000f\u0000d\u001e\u0000d#\u0000Г\u0000\u0003}\u0016\u0000t\u0000\u0000t\u0001\u0000d$\u0000Г\u0002\u0000d\r\u0000|\f\u0000d\u0007\u0000|\u0006\u0000d!\u0000|\u0016\u0000d\"\u0000|\u0010\u0000d%\u0000d\u0019\u0000Г\u0000\u0005Sn\u0001\u0000\u0001|\u000e\u0000d&\u0000j\u0002\u0000oм\u0000\u0001t\u0000\u0000t\u0001\u0000d\u0014\u0000Г\u0002\u0000d\u0015\u0000|\u0007\u0000d\u0016\u0000|\u000e\u0000d\u0017\u0000|\u0011\u0000d\u0018\u0000|\u0012\u0000Г\u0000\u0004}\u0013\u0000t\u0014\u0000|\u0013\u0000Г\u0001\u0000o\u0016\u0000\u0001t\u0000\u0000t\u0015\u0000|\u0013\u0000d\u0019\u0000Г\u0002\u0000d\u001a\u0000Г\u0002\u0000o\"\u0000\u0001t\u0000\u0000t\u0015\u0000|\u0013\u0000d\u0019\u0000Г\u0002\u0000d\u001a\u0000Г\u0002\u0000}\u0010\u0000t\u000f\u0000}\u0012\u0000n\u0001\u0000\u0001|\u0010\u0000\fo\"\u0000\u0001d'\u0000}\u0010\u0000t\u0000\u0000t\u0015\u0000|\u0013\u0000d\u0019\u0000Г\u0002\u0000d(\u0000Г\u0002\u0000}\u0012\u0000n\u0001\u0000\u0001t\u0000\u0000t\u0001\u0000d\u001c\u0000Г\u0002\u0000d\u0017\u0000|\u0011\u0000d\u001d\u0000|\u0012\u0000d\u001e\u0000d#\u0000Г\u0000\u0003}\u0016\u0000t\u0000\u0000t\u0001\u0000d$\u0000Г\u0002\u0000d\r\u0000|\f\u0000d\u0007\u0000|\u0006\u0000d!\u0000|\u0016\u0000d\"\u0000|\u0010\u0000Г\u0000\u0004Sn\u0001\u0000\u0001|\u000e\u0000d)\u0000j\u0002\u0000ou\u0000\u0001t\u0000\u0000t\u0001\u0000d\u0014\u0000Г\u0002\u0000d\u0015\u0000|\u0007\u0000d\u0016\u0000|\u000e\u0000d\u0017\u0000|\u0011\u0000d\u0018\u0000|\u0012\u0000Г\u0000\u0004}\u0013\u0000t\u0000\u0000|\u0003\u0000d*\u0000Г\u0002\u0000d+\u0000t\u0000\u0000|\u0002\u0000d\u0006\u0000Г\u0002\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\u0007\u0000Г\u0001\u0000t\u0000\u0000|\u0002\u0000d\u0003\u0000Г\u0002\u0000d\r\u0000Г\u0001\u0000f\u0003\u0000\u0016Г\u0001\u0000Sn\u0001\u0000\u0001|\u000e\u0000d,\u0000j\u0002\u0000oP\u0000\u0001t\u0000\u0000t\u0001\u0000d\u001c\u0000Г\u0002\u0000d\u0017\u0000t\u000f\u0000d\u001d\u0000|\u0012\u0000d\u001e\u0000d\u001f\u0000Г\u0000\u0003}\u0016\u0000t\u0000\u0000t\u0001\u0000d \u0000Г\u0002\u0000d\r\u0000|\f\u0000d\u0007\u0000|\u0006\u0000d!\u0000|\u0016\u0000d\"\u0000|\u0010\u0000Г\u0000\u0004Sn\u0001\u0000\u0001d\u0000\u0000S(-\u0000\u0000\u0000Nt\u0007\u0000\u0000\u0000REQUESTt\b\u0000\u0000\u0000RESPONSEt\u0003\u0000\u0000\u0000gett\u0005\u0000\u0000\u0000tcodet\u0000\u0000\u0000\u0000t\u0003\u0000\u0000\u0000uidt\u0007\u0000\u0000\u0000id_sitet\u0003\u0000\u0000\u0000tidt\u0007\u0000\u0000\u0000tovaridt\b\u0000\u0000\u0000printtidt\t\u0000\u0000\u0000printerskt\f\u0000\u0000\u0000labelbarcodet\t\u0000\u0000\u0000id_shtaskt\u0007\u0000\u0000\u0000id_cartt\u0003\u0000\u0000\u0000actt\b\u0000\u0000\u0000id_routet\b\u0000\u0000\u0000date_outt\u0005\u0000\u0000\u0000scan1t\f\u0000\u0000\u0000select_routet\u0014\u0000\u0000\u0000GM_CARTINCOME_ROUTESt\u0007\u0000\u0000\u0000BARCODEt\n\u0000\u0000\u0000CHECK_TYPEt\u000b\u0000\u0000\u0000ID_ROUTE_INt\b\u0000\u0000\u0000DATE_OUTi\u0000\u0000\u0000\u0000t\u0003\u0000\u0000\u0000MESt\b\u0000\u0000\u0000ID_ROUTEt\u0019\u0000\u0000\u0000GM_CARTINCOME_LIST_ROUTESt\f\u0000\u0000\u0000DATE_OUT_CURt\u0013\u0000\u0000\u0000CHECK_NOT_END_ROUTEt\u0001\u0000\u0000\u00001t\u0010\u0000\u0000\u0000frm_listCarRoutet\n\u0000\u0000\u0000route_listt\u0003\u0000\u0000\u0000errt\u0001\u0000\u0000\u00000t\u000f\u0000\u0000\u0000frm_setCarRoutet\u0007\u0000\u0000\u0000confirmt\u0005\u0000\u0000\u0000scan2s5\u0000\u0000\u0000ƒл€ завершени€ работы с маршрутом, подтвердите отъездt\r\u0000\u0000\u0000DATE_OUT_CURRt\n\u0000\u0000\u0000setdateoutt\b\u0000\u0000\u0000redirects)\u0000\u0000\u0000taskAction?uid=%s&id_site=%s&id_shtask=%st\u0005\u0000\u0000\u0000start(\u0017\u0000\u0000\u0000t\t\u0000\u0000\u0000_getattr_t\t\u0000\u0000\u0000containert\u0007\u0000\u0000\u0000requestt\b\u0000\u0000\u0000responseR\u0003\u0000\u0000\u0000R\u0005\u0000\u0000\u0000R\u0006\u0000\u0000\u0000R\u0007\u0000\u0000\u0000R\b\u0000\u0000\u0000R\t\u0000\u0000\u0000R\n\u0000\u0000\u0000R\u000b\u0000\u0000\u0000R\f\u0000\u0000\u0000R\r\u0000\u0000\u0000R\u000e\u0000\u0000\u0000t\u0004\u0000\u0000\u0000NoneR \u0000\u0000\u0000R\u000f\u0000\u0000\u0000R\u0010\u0000\u0000\u0000t\u0005\u0000\u0000\u0000routet\u0003\u0000\u0000\u0000lent\t\u0000\u0000\u0000_getitem_R\u001f\u0000\u0000\u0000(\u0017\u0000\u0000\u0000R)\u0000\u0000\u0000R*\u0000\u0000\u0000R+\u0000\u0000\u0000R,\u0000\u0000\u0000R\u0003\u0000\u0000\u0000R\u0005\u0000\u0000\u0000R\u0006\u0000\u0000\u0000R\u0007\u0000\u0000\u0000R\b\u0000\u0000\u0000R\t\u0000\u0000\u0000R\n\u0000\u0000\u0000R\u000b\u0000\u0000\u0000R\f\u0000\u0000\u0000R\r\u0000\u0000\u0000R\u000e\u0000\u0000\u0000R-\u0000\u0000\u0000R \u0000\u0000\u0000R\u000f\u0000\u0000\u0000R\u0010\u0000\u0000\u0000R.\u0000\u0000\u0000R/\u0000\u0000\u0000R0\u0000\u0000\u0000R\u001f\u0000\u0000\u0000(\u0000\u0000\u0000\u0000(\u0000\u0000\u0000\u0000s\u000f\u0000\u0000\u0000Script (Python)t\u000b\u0000\u0000\u0000routeAction\u0001\u0000\u0000\u0000sТ\u0000\u0000\u0000\u000f\u0001\u000f\u0006\u0018\u0001\u0015\u0001\u0015\u0001\u0018\u0001\u0015\u0001\u0015\u0001\u001f\u0001\u0015\u0001\u0015\u0001\u0015\u0001\u0015\u0001\u0006\u0001\u0015\u0001\u0015\b\u001a\u0001\u0014\u0001\u0015\u0001\u0006\u0001\u0006\u0001\t\u0001A\u0001\u000f\u0006\u0018\u0001\u0015\u0001\u0015\u0001\u0018\u0001\u0015\u0001\u0015\u0001\u001f\u0001\u0015\u0001\u0015\u0001\u0015\u0001\u0015\u0001\u0006\u0001\u0015\u0001\u0015\b\u001a\u0001\u0014\u0001\u0015\u0001\u0006\u0001\u0006\u0001\t\u0001&\u0001\u001c\u0001\b\u0001\u001c\u0002$\u0001,\u0003$\u00012\u0002\r\u0001\u0015\u0001\u0006\u0001\u0006\u0001\t\u0001&\u0001\u0018\u0001\n\u0001\b\u0001\u0006\u0001\u001c\u0002$\u0001,\u0002\r\u0001\u0015\u0001\u0006\u0001\u0006\u0001\t\u0001K\u0002\r\u0001$\u0001(\u0001\u0000\u0000\u0000R1\u0000\u0000\u0000(\u0001\u0000\u0000\u0000R1\u0000\u0000\u0000(\u0000\u0000\u0000\u0000(\u0000\u0000\u0000\u0000s\u000f\u0000\u0000\u0000Script (Python)s\b\u0000\u0000\u0000<module>\u0001\u0000\u0000\u0000R\u0004\u0000\u0000\u0000", 
    "func_defaults": null, 
    "_bind_names": "<Shared_DC_Scripts_Bindings_NameAssignments dict={'_asgns': {'name_context': 'context', 'name_subpath': 'traverse_subpath', 'name_m_self': 'script', 'name_container': 'container'}}>", 
    "__ac_local_roles__": {
        "admin": [
            "Owner"
        ]
    }, 
    "_filepath": "Script (Python):/hms/iface/INPUT_TEL/routeAction", 
    "_params": "", 
    "func_code": "<Shared_DC_Scripts_Signature_FuncCode dict={'co_argcount': 0, 'co_varnames': ('_getattr_', 'container', 'request', 'response', 'tcode', 'uid', 'id_site', 'tid', 'tovarid', 'printtid', 'printersk', 'labelbarcode', 'id_shtask', 'id_cart', 'act', 'None', 'err', 'id_route', 'date_out', 'route', 'len', '_getitem_', 'route_list')}>"
}